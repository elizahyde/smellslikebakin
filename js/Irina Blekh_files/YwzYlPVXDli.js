/*!CK:1787038744!*//*1392692546,178179357*/

if (self.CavalryLogger) { CavalryLogger.start_js(["orng9"]); }

__d("EntstreamCollapsedUFIActions",["PopupWindow","React","TrackingNodes","URI","WindowComm","cx","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.createClass({displayName:'EntstreamCollapsedUFIActions',getLikeButton:function(){return this.refs.likeButton.getDOMNode();},getLikeIcon:function(){return this.refs.likeIcon.getDOMNode();},render:function(){var p;if(this.props.shareHref!==null){var q=i.getTrackingInfo(i.types.SHARE_LINK),r=j(this.props.shareHref),s="Share";if(this.props.shareText)s=this.props.shareText;var t=[h.DOM.i({className:"_6k1 _528f"}),s];if(r.getPath().indexOf('/ajax')===0){p=h.DOM.a({ajaxify:this.props.shareHref,className:"_6j_ _5cix",'data-ft':q,href:"#",rel:"dialog",title:"Share this item",role:"button"},t);}else{var u=function(){if(this.props.isPluginPublicUser){var ga=k.makeHandler(function(ha){window.location.reload();});r.addQueryData({next:ga});}g.open(r.toString(),480,600);return false;}.bind(this);p=h.DOM.a({className:"_6j_ _5cix",'data-ft':q,href:this.props.shareHref,onClick:u,target:"_blank",title:"Share this item"},t);}}var v;if(this.props.canComment){var w="_6k4 _528f",x=[h.DOM.i({className:w}),"Comment"],y="_6k2 _5cix",z=i.getTrackingInfo(i.types.COMMENT_LINK),aa;if(this.props.isQAndA){aa="Ask a question...";}else aa="Write a comment...";if(this.props.storyHref){v=h.DOM.a({className:y,'data-ft':z,href:this.props.storyHref,target:"_blank",title:aa},x);}else v=h.DOM.a({className:y,'data-ft':z,href:"#",onClick:this.props.onCommentClick,title:aa},x);}var ba,ca=[h.DOM.i({className:"_6k7 _528f",ref:"likeIcon"}),"Like",h.DOM.div({className:"_55k4"})];if(this.props.canLike){var da=((this.props.hasViewerLiked?"_6k5":'')+(' '+"_6k6")+(' '+"_5cix")),ea=i.getTrackingInfo(this.props.hasViewerLiked?i.types.UNLIKE_LINK:i.types.LIKE_LINK),fa=this.props.hasViewerLiked?"Unlike this":"Like this";if(!this.props.isPluginPublicUser){if(this.props.storyHref&&this.props.likePopup){ba=h.DOM.a({className:da,'data-ft':ea,href:this.props.storyHref,target:"_blank",ref:"likeButton",title:fa},ca);}else ba=h.DOM.a({className:da,'data-ft':ea,href:"#",onClick:this.props.onLike,onMouseDown:this.props.onLikeMouseDown,ref:"likeButton",title:fa},ca);}else ba=h.DOM.a({className:da,'data-ft':ea,href:this.props.storyHref,ref:"likeButton",target:"_blank",title:fa},ca);}return (h.DOM.div({className:"_5ciy"},ba,v,p));}});e.exports=o;});
__d("EntstreamCollapsedUFISentence",["Bootloader","NumberFormat","ProfileBrowserLink","ProfileBrowserTypes","React","URI","cx","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=k.createClass({displayName:'EntstreamCollapsedUFISentence',_showShareDialog:function(event){event=event.nativeEvent;if(event.isDefaultRequested())return;g.loadModules(["EntstreamShareOverlay"],function(p){p.display(this.props.feedback.targetfbid,this._getShareString());}.bind(this));event.prevent();},_getShareString:function(){var p=this.props.feedback.sharecount,q=this.props.numberDelimiter||',';if(p===1){return "1 Share";}else if(p>1){var r=h.formatIntegerWithDelimiter(p,q);return n._("{count} Shares",{count:r});}},render:function(){var p=this.props.feedback,q=p.likecount,r=this.props.commentCount,s=p.sharecount,t=p.seencount,u=this.props.hasAttachedUFIExpanded,v=this.props.numberDelimiter||',';if(u){q=0;r=0;}if(!q&&!r&&!s&&!t)return k.DOM.span(null);var w;if(q===1){w="1 Like";}else if(q>1){var x=h.formatIntegerWithDelimiter(q,v);w=n._("{count} Likes",{count:x});}var y;if(r===1){y="1 Comment";}else if(r>1){var z=h.formatIntegerWithDelimiter(r,v);y=n._("{count} Comments",{count:z});}var aa=this._getShareString(),ba,ca,da;if(w){ca=new l('/ajax/like/tooltip.php').setQueryData({comment_fbid:p.targetfbid,comment_from:p.actorforpost,seen_user_fbids:true});var ea=((y||aa?"prm":''));ba=j.LIKES;da={id:p.targetfbid};var fa=i.constructDialogURI(ba,da).toString();if(this.props.storyHref){w=null;}else w=k.DOM.a({ajaxify:fa,className:ea,href:i.constructPageURI(ba,da).toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':ca.toString(),rel:"dialog"},w);}var ga;if(t>0){ba=j.GROUP_MESSAGE_VIEWERS;da={id:p.targetfbid};var ha=i.constructDialogURI(ba,da),ia=i.constructPageURI(ba,da);ca=new l('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:p.entidentifier,displayed_count:t});var ja=h.formatIntegerWithDelimiter(t,v);if(p.seenbyall){ga="Seen by everyone";}else ga=ja==1?"Seen by 1":n._("Seen by {count}",{count:ja});ga=k.DOM.a({ajaxify:ha.toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':ca.toString(),href:ia.toString(),rel:"dialog",role:"button",tabindex:"-1"},ga);}if(y){var ka=((aa?"prm":''));if(this.props.storyHref){y=k.DOM.a({className:ka,href:this.props.storyHref,target:"_blank"},y);}else y=k.DOM.a({className:ka,href:"#",onClick:this.props.onCommentClick},y);}if(aa){var la=new l('/shares/view').setSubdomain('www').setQueryData({id:p.targetfbid});if(this.props.storyHref){aa=k.DOM.a({href:la.toString(),target:"_blank"},aa);}else aa=k.DOM.a({href:la.toString(),onClick:this._showShareDialog,rel:"ignore"},aa);}return (k.DOM.span({className:"_5civ"},w,y,aa,ga));}});e.exports=o;});
__d("EntstreamCollapsedUFI",["Event","Animation","BrowserSupport","CSS","DOM","Ease","EntstreamCollapsedUFIActions","EntstreamCollapsedUFISentence","PrivacyConstants","React","TrackingNodes","Vector","cx","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=5,v=p.createClass({displayName:'EntstreamCollapsedUFI',_animate:function(w,x,y,z){if(!i.hasCSSTransforms())return;var aa=this.refs.icons.getLikeIcon();this._animation&&this._animation.stop();this._animation=new h(aa).from('scaleX',w).from('scaleY',w).to('scaleX',x).to('scaleY',x).duration(y);z&&this._animation.ease(z);this._animation.go();},bounceLike:function(){this._animate(1.35,1,750,l.bounceOut);},shrinkLike:function(){this._animate(1,.85,150);this._mouseUpListener=g.listen(document.body,'mouseup',this._onMouseUp);},_onMouseUp:function(event){this._mouseUpListener.remove();if(!k.contains(this.refs.icons.getLikeButton(),event.getTarget()))this._animate(.85,1,150);},render:function(){var w=this.props.feedback,x=q.getTrackingInfo(q.types.BLINGBOX),y=w.viewerid===(o.PRIVACY_PROFILE_VIEWAS_EVERYONE_USER).toString();return (p.DOM.div({className:"clearfix"},p.DOM.div({ref:"footer"}),m({isPluginPublicUser:y,canLike:w.viewercanlike,canComment:w.cancomment,hasViewerLiked:w.hasviewerliked,likePopup:this.props.likePopup,onCommentClick:this.props.onCommentClick,onLike:this.props.onLike,onLikeMouseDown:this.props.onLikeMouseDown,ref:"icons",shareHref:this.props.shareHref,shareText:this.props.shareText,storyHref:this.props.storyHref,isQAndA:w.isqanda}),p.DOM.div({className:"_6j-",'data-ft':x,ref:"sentence"},n({commentCount:this.props.commentCount,feedback:w,hasAttachedUFIExpanded:this.props.hasAttachedUFIExpanded,numberDelimiter:this.props.numberDelimiter,onCommentClick:this.props.onCommentClick,storyHref:this.props.storyHref}))));},componentDidMount:function(){var w=this.getDOMNode(),x=this.refs.icons.getDOMNode(),y=this.refs.sentence.getDOMNode(),z,aa,ba;t(function(){z=r.getElementDimensions(w).x;aa=r.getElementDimensions(x).x;ba=r.getElementDimensions(y).x;},function(){if(aa+ba>z-u)j.addClass(w,"_5ext");});}});e.exports=v;});
__d("EntstreamCollapsedUFIController",["Bootloader","CommentPrelude","CSS","DOM","EntstreamCollapsedUFI","React","ReactMount","UFICentralUpdates","UFIConstants","UFIFeedbackTargets","UFIToplevelCommentList","UFIUserActions","UIPagelet","copyProperties","csx","cx","onEnclosingPageletDestroy"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=o.UFIPayloadSourceType;function y(z,aa,ba){this._root=z;this._id=ba.ftentidentifier;this._contextArgs=ba;this._ufiVisible=ba.hasattachedufiexpanded;this._ufiRendered=!ba.pageletdata;this._updateSubscription=n.subscribe('feedback-updated',function(ca,da){if(da.payloadSource!=x.INITIAL_SERVER&&this._id in da.updates)this.render();}.bind(this));n.handleUpdate(o.UFIPayloadSourceType.COLLAPSED_UFI,aa);g.loadModules(["ScrollAwareDOM"],function(ca){m.scrollMonitor=ca.monitor;});w(this._root,this.destroy.bind(this));}t(y.prototype,{_onLike:function(event){this._feedbackSubscription=p.getFeedbackTarget(this._id,function(z){r.changeLike(this._id,!z.hasviewerliked,{source:this._contextArgs.source,target:event.target,rootid:j.getID(this._root)});}.bind(this));this._ufi.bounceLike();if(!this._ufiVisible&&!this._ufiRendered){this._ufiVisible=true;i.removeClass(this._root.parentNode,'collapsed_comments');this._loadAndRenderUFIPagelet();}event.preventDefault();},_onLikeMouseDown:function(event){this._ufi.shrinkLike();event.preventDefault();},_onCommentClick:function(event){if(!this._ufiVisible){this._ufiVisible=true;i.addClass(this._root,"_6ka");if(!this._ufiRendered)this._loadAndRenderUFIPagelet();}h.click(this._root,this._ufiRendered);event.preventDefault();},_loadAndRenderUFIPagelet:function(){i.addClass(this._root.parentNode,"_5r7o");s.loadFromEndpoint('EntstreamUFIPagelet',j.find(this._root.parentNode,"._5kuo"),this._contextArgs.pageletdata,{displayCallback:this._onUFIPageletLoadComplete.bind(this)});},_onUFIPageletLoadComplete:function(z){z();setTimeout(h.expand.bind(null,this._root),0);this._ufiRendered=true;},render:function(){this._feedbackSubscription=p.getFeedbackTarget(this._id,function(z){var aa=q.getCommentListForFeedbackTargetID_UNSAFE(this._id).getDisplayedCommentCount(),ba=k({commentCount:aa,feedback:z,hasAttachedUFIExpanded:this._contextArgs.hasattachedufiexpanded,likePopup:this._contextArgs.likepopup,numberDelimiter:this._contextArgs.numberdelimiter,onCommentClick:this._onCommentClick.bind(this),onLike:this._onLike.bind(this),onLikeMouseDown:this._onLikeMouseDown.bind(this),shareHref:this._contextArgs.sharehref,shareText:this._contextArgs.sharetext,storyHref:this._contextArgs.storyhref});l.renderComponent(ba,this._root);this._ufi=this._ufi||ba;}.bind(this));},destroy:function(){if(this._feedbackSubscription){p.unsubscribe(this._feedbackSubscription);this._feedbackSubscription=null;}this._updateSubscription.unsubscribe();this._updateSubscription=null;l.unmountComponentAtNode(this._root);this._root=null;this._id=null;this._contextArgs=null;this._ufiVisible=null;}});e.exports=y;});
__d("EntstreamUFI",["Arbiter","Parent","UFICentralUpdates","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k){var l={};i.subscribe('feedback-updated',function(n,o){var p=o.updates;for(var q in p){if(!l[q])continue;l[q].forEach(function(r){if(k(r)){var s=h.byClass(k(r),"_6ns");s&&g.inform('Entstream/StoryUpdated',{story:s});}});}});var m={register:function(n,o){var p=l[o]||(l[o]=[]);p.push(n);}};e.exports=m;});
__d("LitestandShareAttachment",["CSS","DOM","LitestandEllipsis","Parent","csx","cx","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=16,o=22,p=5,q=3,r=10,s={init:function(u,v){var w,x,y,z,aa,ba,ca=v?q:p;m(function(){z=j.byClass(u,"_31r");if(z&&!g.hasClass(z,"_31q"))g.addClass(z,"_5fxa");x=h.find(u,"._6m3");w=h.find(u,"._6m6");y=h.find(u,"._59tj");aa=h.scry(u,"._6m7")[0];ba=t(x,w,y,ca);},function(){if(!ba){aa&&g.hide(aa);i.add(w,ca*o);}else if(aa&&ba){g.show(aa);i.add(aa,ba*n);}z&&g.removeClass(z,"_5fxa");});}};function t(u,v,w,x){var y=Math.round(v.scrollHeight/o);if(y>=x)return 0;var z=u.offsetHeight-v.scrollHeight-w.scrollHeight-r;return Math.floor(z/n);}e.exports=s;});